
1. 登录后通过用户账号/session获得
{
    table_id: 2, //int
}
2. 根据table_id得到 四个人共有的信道 牌的编号数组 ，私人信道，玩家信息
```
fetch(url,{table_id:2})

```
返回值
```
{
    channel_id: int,  // 四个人共有的信道
    board_id_list:[12,13,14,15,16...],//牌的编号数组
    private_channel_id: int,// 私人信道
    players:{
        E:{name:'宏鸿',rank:"大师",positon:"E"}
        S:{name:'宏鸿1',rank:"大师",positon:"S"}
        W:{name:'宏鸿2',rank:"大师",positon:"W"}
        N:{name:'宏鸿3',rank:"大师",positon:"N"}
    }
}
```
3. 发送准备请求
牌号是2，东玩家发送准备请求

```
fetch(url,{
    board_id:2,
    seat:'E',
})
```
这时，通过长轮询知道有人做出了动作
再单独请求消息
fetch(url,{
    channel_id:2,
    pollingId:999,
})
返回值
```
{
    state:'ready',//表示当前是准备阶段
    ready:"E", //东玩家准备
    nextPlayer:'S',//该南玩家
    allReady:false //是否都准备好，
    pollingId: 1000,//当前消息的id
}
```
4. 请求牌的数据
fetch(url,{
    board_id:2,
    seat:'E',
})
```
{
    cards:['S8','S7','H8','H7',...] , //只发当前玩家的牌
    dealer:"N",第一个叫牌的人
    vulnerable:"NO",
}
```
5. 叫牌
fetch(url,{
    board_id:2,
    seat:'E',
    card:"S2",
    channel_id:3,//是否需要channel_id
})
这时，通过长轮询知道有人做出了动作
再单独请求消息
fetch(url,{
    channel_id:2,
    pollingId:999,
})
返回值
```
{
    state:'bidding',//表示当前是叫牌阶段
    seat:'E', //东玩家准备
    card:"S2",//叫牌 黑桃2
    nextPlayer:'S',//该南玩家
    isBidComleted: false, //当正常叫牌，3个连续pass，表示叫牌完成，变成true
    valid:true,  //从开始连续四次pass，表示无效，变成false
    declare:'E',//庄家，在没有确定庄家之前是空值
    contract：'H6',定约
    openlead：'S',//首攻
    pollingId: 1000,//当前消息的id
}
```

6. 打牌
fetch(url,{
    board_id:2,
    seat:'E',
    card:"S8"
})

这时，通过长轮询知道有人做出了动作
再单独请求消息
fetch(url,{
    channel_id:2,
    pollingId:999,
})
返回值
```
{
    state:'playing',//表示当前是打牌阶段
    seat:"E", //东玩家打的牌
    card:'S8', //黑桃8
    nextPlayer:"S",//下一个要打牌的人
    ns_win：2,//当前南北赢两墩
    ew_win:3,//当前东西赢三墩
    cardNumber: 1,//总共52张牌，这是打的第一张牌，
    dummy:["S5",'D5',...],// 表示明手的牌，只有打第一张牌时，才有这条消息
    result:
    pollingId: 1000,//当前消息的id
}
```
7. 摊牌
fetch(url,{
    board_id:2,
    seat:'E', //东家摊牌
    claimNumber: 5,//可以赢5墩
})
这时，通过长轮询知道有人做出了动作
再单独请求消息
fetch(url,{
    channel_id:2,
    pollingId:999,
})

```
{
    state:"claim",// 表示摊牌阶段
    seat:'E', //东家摊牌
    action:"askClaim"
    claimNumber: 5,//可以赢5墩
}
```

8. 同意 拒绝摊牌
fetch(url,{
    board_id:2,
    seat:'S', //南家接受摊牌
    agreeClaim: true,
})
这时，通过长轮询知道有人做出了动作
再单独请求消息
fetch(url,{
    channel_id:2,
    pollingId:999,
})

```
{
    state:"claim",// 表示摊牌阶段
    seat:'S', //南家接受摊牌
    agreeClaim: true,  //
    claimState:'await', //三个状态：1.等待另一个玩家，2摊牌通过：success，3.摊牌失败：fail   
}
```



## 后端数据
```
{
  "id": 1,
  "name": "1,N,NO",
  "deal_id": {
    "id": 1,
    "name": "1,N,NO"
  },
  "table_id": {
    "id": 1,
    "name": "open,1,A组循环赛.1, 2 晴天队 vs 4 快乐桥牌"
  },
  "round_id": {
    "id": 1,
    "name": "A组第1轮"
  },
  "phase_id": {
    "id": 1,
    "name": "A组循环赛"
  },
  "game_id": {
    "id": 1,
    "name": "2018石家庄赛"
  },
  "match_id": {
    "id": 1,
    "name": "A组循环赛.1, 2 晴天队 vs 4 快乐桥牌"
  },
  "host_id": {
    "id": 2,
    "name": "晴天队"
  },
  "guest_id": {
    "id": 4,
    "name": "快乐桥牌"
  },
  "number": 1,
  "vulnerable": "NO",
  "dealer": "N",
  "hands": "[[\"S5\", \"S4\", \"S3\", \"S2\", \"H5\", \"H4\", \"H3\", \"D5\", \"D4\", \"D3\", \"C5\", \"C4\", \"C3\"], [\"S8\", \"S7\", \"S6\", \"HA\", \"HK\", \"HQ\", \"DA\", \"DK\", \"DQ\", \"CA\", \"CK\", \"CQ\", \"C2\"], [\"SJ\", \"ST\", \"S9\", \"HJ\", \"HT\", \"H9\", \"DJ\", \"DT\", \"D9\", \"D2\", \"CJ\", \"CT\", \"C9\"], [\"SA\", \"SK\", \"SQ\", \"H8\", \"H7\", \"H6\", \"H2\", \"D8\", \"D7\", \"D6\", \"C8\", \"C7\", \"C6\"]]",
  "sequence": 1,
  "declarer": false,
  "contract": false,
  "openlead": false,
  "result": 0,
  "ns_point": 0,
  "ew_point": 0,
  "host_imp": 0,
  "guest_imp": 0,
  "auction": "[null, \"Pass\", \"2C\", \"x\", \"xx\", \"7NT\"]",
  "tricks": "[]",
  "last_trick": "[]",
  "current_trick": "[]",
  "ns_win": 0,
  "ew_win": 0,
  "claimer": false,
  "claim_result": 0,
  "player": "E",
  "state": "bidding"
}
```